# Python处理脚本说明文档

本文件夹包含了用于处理对话数据的所有Python脚本。这些脚本按照数据处理流程的顺序编写，用于将原始CSV对话数据转换为结构化的评测集。

## 📁 脚本列表及执行顺序

### 1. 数据切分阶段
- **`对话切分脚本.py`** - 初始版本的对话切分脚本
- **`改进版对话切分脚本.py`** - 改进版对话切分脚本（未使用）

### 2. 文件重命名阶段  
- **`重命名脚本.py`** - 基础版本的文件重命名脚本
- **`优化重命名脚本.py`** - 将轮次数提前到文件名开头

### 3. 数据分段阶段
- **`分段切分脚本.py`** - 将对话按50轮分段，创建session文件夹结构

### 4. 评测集生成阶段
- **`评测集生成脚本.py`** - 生成包含CHARACTER_SETTING和DIALOGUE_HISTORY的CSV评测集

### 5. 格式转换阶段
- **`CSV转Excel脚本.py`** - 将CSV文件转换为Excel格式，优化中文显示

### 6. 数据补充阶段
- **`添加标识列脚本.py`** - 为评测完成的Excel文件添加SESSION_ID和SEGMENT_INFO列

## 🔄 完整数据处理流程

```
原始CSV数据
    ↓
对话切分脚本.py → JSON格式对话文件
    ↓
优化重命名脚本.py → 标准化文件命名
    ↓
分段切分脚本.py → 50轮分段的session文件夹
    ↓
评测集生成脚本.py → CSV评测集
    ↓
CSV转Excel脚本.py → Excel格式评测集
    ↓
添加标识列脚本.py → 完整的带标识列Excel文件
```

## 📊 处理的数据规模

- **原始数据**：4,774条对话记录
- **Session数量**：20个（150-250轮对话）
- **分段总数**：100个（每50轮一段）
- **最终评测集**：100行数据，包含完整的角色设定和对话历史

## 🎯 脚本特点

### 技术亮点：
1. **编码处理**：支持中文UTF-8编码
2. **数据验证**：包含完整的错误处理和日志记录
3. **格式优化**：Excel文件针对中文内容优化列宽和行高
4. **精确匹配**：通过内容匹配确保数据一致性

### 输出质量：
- 所有JSON文件都经过格式验证
- Excel文件具有良好的可读性
- 完整的处理日志便于追踪

## 🚀 使用方法

每个脚本都可以独立运行：

```bash
cd "Python处理脚本"
python3 脚本名.py
```

脚本会自动处理输入输出路径，并生成相应的结果文件和处理日志。

## 📝 注意事项

1. 确保Python环境已安装pandas和openpyxl库
2. 脚本中的路径都是绝对路径，可根据需要调整
3. 每个脚本执行前会检查输入文件是否存在
4. 所有脚本都会生成处理日志，便于问题排查

---

*创建时间：2025年9月2日*  
*作者：Claude Code Assistant*  
*版本：v1.0*